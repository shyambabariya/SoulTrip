<% layout("layouts/boilerplate") -%>
<style>
  .filter-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
    gap: 1rem;
    max-width: 100%;
    overflow: hidden;
    padding: 0.8rem 0;
  }
  .filter-nav {
    display: flex;
    align-items: center;
    flex: 1;
    min-width: 0;
  }
  .filter-container {
    overflow-x: auto;
    white-space: nowrap;
    scroll-behavior: smooth;
    display: flex;
    gap: 1rem;
    padding: 0.8rem;
    width: 80%;
  }
  .filter-container::-webkit-scrollbar {
    display: none;
  }
  .filter-item {
    flex: 0 0 auto;
    text-align: center;
    background: #fff;
    border-radius: 0.8rem;
    padding: 0.4rem 0.4rem;
    min-width: 5.6rem;
    box-shadow: 0 0 6px rgba(0, 0, 0, 0.1);
    transition: 0.3s;
  }
  .filter-item:hover {
    transform: scale(1.05);
    background: #f1f1f1;
    cursor: pointer;
  }
  .filter-item i {
    font-size: 20px;
    color: #dc3545;
  }
  .filter-item p {
    font-size: 0.9rem;
    color: #333;
    margin-bottom: 0;
  }
  .scroll-btn {
    border: none;
    background-color: #fff;
    box-shadow: 0 0 6px rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    /* margin: 0 10px; */
    cursor: pointer;
    transition: 0.3s;
    flex-shrink: 0;
  }
  .scroll-btn:hover {
    background-color: #f8d7da;
  }
  .scroll-btn i {
    color: #dc3545;
  }
  .tax-toggle {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: #fff;
    border-radius: 30px;
    padding: 6px 14px;
    box-shadow: 0 0 6px rgba(0, 0, 0, 0.1);
    white-space: nowrap;
    transition: 0.3s;
  }
  .tax-toggle:hover {
    background-color: #f8d7da33;
  }
  .tax-toggle label {
    font-size: 14px;
    color: #333;
  }

  /*Small screen icon-only toggle */
  .tax-btn-sm {
    display: none;
    border: none;
    background: #fff;
    box-shadow: 0 0 6px rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    justify-content: center;
    align-items: center;
    flex-shrink: 0;
  }
  .tax-btn-sm i {
    color: #dc3545;
    font-size: 18px;
  }
  .tax-btn-sm:hover {
    background: #f8d7da;
  }
  @media (max-width: 768px) {
    .tax-toggle {
      display: none;
    }
    .tax-btn-sm {
      display: flex;
    }
  }
</style>
<body>
  <!-- <h2>All Listings</h2> -->
  <div class="filter-bar">
    <div class="filter-nav">
      <button id="backBtn" class="scroll-btn">
        <i class="fa-solid fa-chevron-left"></i>
      </button>
      <div class="filter-container" id="scrollArea">
        <div class="filter-item">
          <i class="fa-solid fa-fire"></i>
          <p>Trending</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-bed"></i>
          <p>Rooms</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-mountain-city"></i>
          <p>Cities</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-mountain-sun"></i>
          <p>Mountains</p>
        </div>
        <div class="filter-item">
          <i class="fa-brands fa-fort-awesome"></i>
          <p>Castles</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-person-swimming"></i>
          <p>Pools</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-campground"></i>
          <p>Camping</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-cow"></i>
          <p>Farms</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-snowman"></i>
          <p>Arctic</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-igloo"></i>
          <p>Domes</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-sun"></i>
          <p>Beach</p>
        </div>
        <div class="filter-item">
          <i class="fa-solid fa-tree"></i>
          <p>Forest</p>
        </div>
      </div>
      <button id="forwardBtn" class="scroll-btn">
        <i class="fa-solid fa-chevron-right"></i>
      </button>
    </div>

    <!-- Tax toggle added inline -->
    <div class="tax-toggle" title="Enable to view total price including taxes">
      <div class="form-check form-switch m-0">
        <input
          class="form-check-input"
          type="checkbox"
          role="switch"
          id="switchCheckDefault"
        />
        <label class="form-check-label" for="switchCheckDefault"
          >Display total after Taxes</label
        >
      </div>
    </div>
    <button
      class="tax-btn-sm"
      id="showTaxBtn"
      title="Toggle tax display"
    >
      <i class="fa-solid fa-receipt"></i>
    </button>
  </div>
  <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1">
    <% for (let listing of listings) {%>
    <a href="/listings/<%=listing._id%>" class="listing-link">
      <div class="card listing-card-home">
        <img
          src="<%=listing.image.url%>"
          class="card-img-top"
          alt="listing image"
        />
        <div class="card-img-overlay"></div>

        <div class="card-body">
          <p class="card-text">
            <b><%= listing.title %> </b>
            <br />
            &#8377; <%=listing.price.toLocaleString("en-IN")%> / night
            <i class="tax-info" style="display: none">&nbsp;+18% GST</i>
          </p>
        </div>
      </div>
    </a>
    <%}%>
  </div>
</body>
<script>
  let taxSwitch = document.getElementById("switchCheckDefault");
  const taxBtnSm = document.getElementById("showTaxBtn");

  taxSwitch.addEventListener("click", () => {
    let taxInfo = document.getElementsByClassName("tax-info");
    for (info of taxInfo) {
      if (info.style.display != "inline") {
        info.style.display = "inline";
      } else {
        info.style.display = "none";
      }
    }
  });

  taxBtnSm.addEventListener("click", () => {
    let taxInfo = document.getElementsByClassName("tax-info");
    for (info of taxInfo) {
      if (info.style.display != "inline") {
        info.style.display = "inline";
      } else {
        info.style.display = "none";
      }
    }
  });


  const scrollArea = document.getElementById("scrollArea");
  const forwardBtn = document.getElementById("forwardBtn");
  const backBtn = document.getElementById("backBtn");

  forwardBtn.addEventListener("click", () => {
    scrollArea.scrollBy({ left: 300, behavior: "smooth" });
  });

  backBtn.addEventListener("click", () => {
    scrollArea.scrollBy({ left: -300, behavior: "smooth" });
  });

  // Smooth horizontal scroll with mouse wheel
  scrollArea.addEventListener("wheel", (e) => {
    e.preventDefault();
    scrollArea.scrollLeft += e.deltaY;
  });
</script>
